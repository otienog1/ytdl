# Alternative: Extract Cookies Using Browser Extension

If Puppeteer gives you trouble, here's a simpler method using a browser extension.

## Method 1: Get cookies.txt LOCALLY (Recommended)

### Step 1: Install Extension

**Chrome/Edge:**
1. Go to: https://chrome.google.com/webstore/detail/get-cookiestxt-locally/cclelndahbckbenkjhflpdbgdldlbecc
2. Click "Add to Chrome"

**Firefox:**
1. Go to: https://addons.mozilla.org/en-US/firefox/addon/cookies-txt/
2. Click "Add to Firefox"

### Step 2: Log into YouTube

1. Go to https://www.youtube.com
2. Click "Sign In" and log in with your Google account
3. Make sure you're fully logged in (see your profile picture)

### Step 3: Export Cookies

1. Click the extension icon in your browser toolbar
2. Click "Export" or "Download cookies"
3. Save the file as `youtube_cookies.txt`

### Step 4: Use the Cookies

**For local use:**
```bash
# The cookies are already in the right format!
yt-dlp --cookies youtube_cookies.txt https://youtube.com/shorts/VIDEO_ID
```

**For server:**
```bash
# Upload to server
scp youtube_cookies.txt root@172.234.172.191:/opt/ytdl/

# Set permissions
ssh root@172.234.172.191
sudo chown ytd:ytd /opt/ytdl/youtube_cookies.txt
sudo chmod 600 /opt/ytdl/youtube_cookies.txt

# Restart services
sudo systemctl restart ytd-api ytd-worker
```

## Method 2: EditThisCookie

Another popular option:

### Install
- Chrome: https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg

### Export
1. Go to YouTube.com (logged in)
2. Click EditThisCookie icon
3. Click "Export" button (looks like a download arrow)
4. Cookies are copied to clipboard
5. Paste into a text file
6. **Important**: Need to convert from JSON to Netscape format (see below)

### Convert JSON to Netscape

If you have JSON cookies, use this Python script:

```python
import json

# Read JSON cookies
with open('cookies.json', 'r') as f:
    cookies = json.load(f)

# Convert to Netscape format
with open('youtube_cookies.txt', 'w') as f:
    f.write('# Netscape HTTP Cookie File\n')
    f.write('# This file is generated by EditThisCookie\n\n')

    for cookie in cookies:
        if 'youtube.com' in cookie.get('domain', '') or 'google.com' in cookie.get('domain', ''):
            domain = cookie.get('domain', '')
            if not domain.startswith('.'):
                domain = '.' + domain

            f.write(f"{domain}\t")
            f.write(f"TRUE\t")
            f.write(f"{cookie.get('path', '/')}\t")
            f.write(f"{'TRUE' if cookie.get('secure', False) else 'FALSE'}\t")
            f.write(f"{int(cookie.get('expirationDate', 0))}\t")
            f.write(f"{cookie.get('name', '')}\t")
            f.write(f"{cookie.get('value', '')}\n")

print("Converted to youtube_cookies.txt")
```

## Method 3: Manual Export from DevTools

### Chrome/Edge/Firefox

1. Go to YouTube.com (logged in)
2. Press F12 to open DevTools
3. Go to "Application" tab (Chrome/Edge) or "Storage" tab (Firefox)
4. Click "Cookies" → "https://www.youtube.com"
5. Right-click on the cookie list → "Copy all as cURL"
6. Use an online tool to convert cURL to Netscape cookies

**Note**: This method is more complex. Use Method 1 instead.

## Comparison

| Method | Ease | Format | Notes |
|--------|------|--------|-------|
| **Get cookies.txt LOCALLY** | ⭐⭐⭐⭐⭐ | Netscape (ready!) | Best option |
| **EditThisCookie** | ⭐⭐⭐ | JSON (needs conversion) | Popular but extra step |
| **DevTools Manual** | ⭐ | Various (complex) | Not recommended |
| **Puppeteer Script** | ⭐⭐⭐⭐ | Netscape (ready!) | Automated but may have issues |

## Which Should You Use?

**For one-time setup:** Use "Get cookies.txt LOCALLY" extension (Method 1)
- Easiest
- Already in correct format
- No conversion needed

**For automation:** Use Puppeteer script (this tool)
- Scriptable
- Can run on servers (with Xvfb)
- No manual clicking

## Troubleshooting Browser Extension Method

### Cookies don't work with yt-dlp

**Check format:**
```bash
head youtube_cookies.txt
```

Should see:
```
# Netscape HTTP Cookie File
.youtube.com    TRUE    /    TRUE    1234567890    SSID    ...
```

If you see JSON (`{` and `}`), you need to convert (see Method 2 above).

### Missing important cookies

Make sure you're logged in to YouTube when exporting. Check for these cookies:
- SSID
- APISID
- SAPISID
- LOGIN_INFO
- __Secure-1PSID

### Cookies expire quickly

This is normal with 2FA. Just re-export every few weeks.

## Security Note

The cookie file contains your YouTube authentication. Treat it like a password:
- Don't share it
- Don't commit to Git
- Set permissions: `chmod 600 youtube_cookies.txt`
- Delete when done testing

## Summary

**Simplest workflow:**
1. Install "Get cookies.txt LOCALLY" extension
2. Go to YouTube → Log in
3. Click extension → Export
4. Upload to server
5. Done!

Takes 2 minutes and works 100% of the time.
