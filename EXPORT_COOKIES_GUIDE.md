# How to Export Fresh YouTube Cookies

Your YouTube cookies have expired and need to be re-exported from your browser. Here's how to do it:

## Step 1: Install Browser Extension

Choose one of these browser extensions to export cookies:

### For Chrome/Edge:
- **Get cookies.txt LOCALLY** (Recommended)
  - Chrome: https://chrome.google.com/webstore/detail/get-cookiestxt-locally/cclelndahbckbenkjhflpdbgdldlbecc
  - Edge: Search for "Get cookies.txt LOCALLY" in Edge Add-ons

### For Firefox:
- **cookies.txt**
  - Firefox: https://addons.mozilla.org/en-US/firefox/addon/cookies-txt/

## Step 2: Login to YouTube

1. Open your browser
2. Go to https://www.youtube.com
3. **Login to your YouTube account** (this is critical!)
4. Browse around YouTube a bit (watch a video, search for something)

## Step 3: Export Cookies

1. Click on the cookies extension icon in your browser
2. Click "Export" or "Get cookies.txt"
3. Save the file as `youtube_cookies.txt`

**IMPORTANT**: The cookies file should start with lines like:
```
# Netscape HTTP Cookie File
# This file is generated by yt-dlp.  Do not edit.

.youtube.com	TRUE	/	TRUE	1234567890	CONSENT	YES+...
.youtube.com	TRUE	/	TRUE	1234567890	LOGIN_INFO	...
```

## Step 4: Upload to Server

Upload the new cookies file to your server:

```bash
# From your local machine
scp youtube_cookies.txt root@172.234.172.191:/opt/ytdl/youtube_cookies.txt

# On the server, set correct permissions
ssh root@172.234.172.191
sudo chown ytd:ytd /opt/ytdl/youtube_cookies.txt
sudo chmod 640 /opt/ytdl/youtube_cookies.txt
```

## Step 5: Restart Services

```bash
sudo systemctl restart ytd-worker ytd-api ytd-beat
```

## Step 6: Test

Wait 10-15 seconds for services to fully restart, then test with a YouTube Short:
- URL: https://www.youtube.com/shorts/Y2c_QxlVK0Y

Monitor the logs while testing:
```bash
sudo journalctl -u ytd-worker -f
```

## Verification

If cookies are valid, you should see in the logs:
- No warning about invalid cookies
- Successful video information fetch
- Download proceeding normally

If cookies are still invalid, you'll see:
```
WARNING: [youtube] The provided YouTube account cookies are no longer valid
```

## Troubleshooting

### Cookies Still Invalid After Export
- Make sure you're logged into YouTube before exporting
- Try watching a YouTube Short in your browser first, then export cookies
- Clear your browser cookies for YouTube, login again fresh, then export

### Alternative: Try Different Browser
If one browser's cookies don't work, try exporting from a different browser (Chrome vs Firefox)

### Still Not Working?
If fresh cookies still fail, YouTube may be aggressively blocking this server's IP. In that case, you'll need to use a residential proxy (see INSTALLATION.md for proxy setup instructions).

## Important Notes

- **Cookies expire periodically** - YouTube rotates them as a security measure
- **Don't share your cookies file** - It contains your session authentication
- **Keep cookies file secure** - Use permissions 640 (read for ytd user only)
- **Login is required** - Anonymous/logged-out cookies won't work

## Current Status

✅ Cookies support is enabled in the code
✅ Code is using web player client with cookies
✅ Cookies file path is configured correctly
❌ Current cookies are expired (need to re-export)

## Next Step

Export fresh cookies following the steps above, upload to server, and test.
